/*
  This class has been generated by the Code Generator
*/

package com.laiyifen.bpc.core;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.busobject.QueryObject;


public class BPC_BUDGET_SUBJECT_BUSINESS extends BPC_BUDGET_SUBJECT_BUSINESSBase
{
    public BPC_BUDGET_SUBJECT_BUSINESS()
    {
        this((BusObjectConfig)null);
    }

    public BPC_BUDGET_SUBJECT_BUSINESS(BusObjectConfig config)
    {
        super(config);
    }

    public static BusObjectIterator<com.laiyifen.bpc.core.BPC_BUDGET_SUBJECT_BUSINESS> getBudgetBusinessMatter()
    {
    	 String queryText = "select distinct business_matter from  BPC_BUDGET_SUBJECT_BUSINESS ";
         QueryObject query = new QueryObject(queryText);
         query.setResultClass(BPC_BUDGET_SUBJECT_BUSINESS.class);
         return query.getObjects();
    }

    public static BusObjectIterator<com.laiyifen.bpc.core.BPC_BUDGET_SUBJECT_BUSINESS> getBudgetBusinessNameByMatter(String strMatter)
    {
    	String queryText = "select distinct business_code ,business_name from  BPC_BUDGET_SUBJECT_BUSINESS where business_matter = :BUSINESS_MATTER ";
        QueryObject query = new QueryObject(queryText);
        query.addParameter("BUSINESS_MATTER", "BPC_BUDGET_SUBJECT_BUSINESS.BUSINESS_MATTER", QueryObject.PARAM_STRING,strMatter);
        query.setResultClass(BPC_BUDGET_SUBJECT_BUSINESS.class);
        return query.getObjects();
    }
    
    public static String getBudgetWorkflowByBusiness(String business_code , String business_type){
    	String retString;
    	String queryText = "select distinct workflow_code_1,workflow_code_2 from  BPC_BUDGET_SUBJECT_BUSINESS where business_code = :BUSINESS_CODE ";
        QueryObject query = new QueryObject(queryText);
        query.addParameter("BUSINESS_CODE", "BPC_BUDGET_SUBJECT_BUSINESS.BUSINESS_CODE", QueryObject.PARAM_STRING,business_code);
        query.setResultClass(BPC_BUDGET_SUBJECT_BUSINESS.class);
        BPC_BUDGET_SUBJECT_BUSINESS bpcbusiness = (BPC_BUDGET_SUBJECT_BUSINESS)query.getObject();
        if(business_type==null || "".equals(business_type) || business_type.indexOf("总部")>-1){
        	retString = bpcbusiness.getWORKFLOW_CODE_1();
        }else{
        	retString = bpcbusiness.getWORKFLOW_CODE_2();
        }
		return retString;
    }
    
    public static BusObjectIterator<com.laiyifen.bpc.core.BPC_BUDGET_SUBJECT_BUSINESS> getBudgetSBObjectsByBusiness(String year,String business_code,String subject_code,String subject_name){
    	StringBuffer queryText = new StringBuffer("select * from bpc_budget_subject_business where 1=1 ");
    	if (!"".equals(year)){
    		queryText.append(" and year ='" + year +"'");
    	}
    	 if (!"".equals(business_code)){
     		queryText.append(" and business_code ='"+ business_code +"' ");
     	}
    	 if (!"".equals(subject_code)){
     		queryText.append(" and BUDGET_SUBJECT_CODE_SAP LIKE '%" + subject_code + "%'");
     	}
    	 if (!"".equals(subject_name)){
     		queryText.append(" and BUDGET_SUBJECT_NAME LIKE '%"+ subject_name +"%'");
     	}
    	QueryObject query = new QueryObject(queryText.toString());
    	query.setResultClass(BPC_BUDGET_SUBJECT_BUSINESS.class);
		return query.getObjects();
    }

}
