/*
  This class has been generated by the Code Generator
*/

package com.laiyifen.shop;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.event.AttributeInitializeEvent;
import com.laiyifen.common.core.User;
import com.laiyifen.common.util.GUIDUtil;
/*
 * 插入复合对象前初始化操作.
 * @Author Jiang.
 */
public class SHOP_TARGET_ESTIMATION extends SHOP_TARGET_ESTIMATIONBase
{
	private GUIDUtil guidGenerator = null;
    private String guidValue = null;
    private User userObj = null;
    /**
     * 获取当前人的基本信息
     * @param 
     * @return
     */
    public User getCurrUserInfo()
    {
    	if( this.userObj==null)
    	{
    		this.userObj= User.getUserInfo();
    	}
    	return this.userObj;
    }
    
    public SHOP_TARGET_ESTIMATION()
    {
        this((BusObjectConfig)null);
    }

    public SHOP_TARGET_ESTIMATION(BusObjectConfig config)
    {
        super(config);
    }
    /*
     * 插入复合对象前初始化GUID,DEPMENTCODE,DEPTMENTNAME,OPERATORNAME,OPERATORCODE和OPERATINGDATE值
     * @see com.cordys.cpc.bsf.busobject.BusObject#onBeforeInsert()
     */
    public void onBeforeInsert() {
    	
    	if(guidGenerator == null)
		{
			guidGenerator = new GUIDUtil();
		}
		if(guidValue == null)
		{
			guidValue=guidGenerator.setGUID(null);
		}
		if(this.getID()==null || this.getID().equals("")){
			this.setID(guidValue);
		}
		
		if(this.getDEPTMENT_CODE()==null || this.getDEPTMENT_CODE().equals("")){
			this.setDEPTMENT_CODE(this.getCurrUserInfo().getDeptCode());
		}
		
		if(this.getDEPTMENT_NAME()==null || this.getDEPTMENT_NAME().equals("")){
			this.setDEPTMENT_NAME(this.getCurrUserInfo().getDeptName());
		}
		
		if(this.getOPERATOR_NAME()==null || this.getOPERATOR_NAME().equals("")){
			this.setOPERATOR_NAME(this.getCurrUserInfo().getUserName());
		}
		
		if(	this.getOPERATOR_CODE()==null || this.getOPERATOR_CODE().equals("")){
			this.setOPERATOR_CODE(this.getCurrUserInfo().getUserCode());
		}
		
		if(this.getOPERATING_DATE()==null || this.getOPERATING_DATE().equals("")){
			this.setOPERATING_DATE(new java.util.Date());
		}
	}
    
    /*
     * 初始化用户角色
     */
	public void onInitialize_OPERATOR_ROLE(AttributeInitializeEvent context){
    	context.setInitialValue(this.getCurrUserInfo().getRoleNameList());
    }
}
