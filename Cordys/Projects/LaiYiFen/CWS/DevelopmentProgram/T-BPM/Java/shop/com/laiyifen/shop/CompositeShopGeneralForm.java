/*
  This class has been generated by the Code Generator
*/

package com.laiyifen.shop;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.event.AfterCommitObjectEvent;
import com.cordys.cpc.bsf.util.ObjectHelper;
import com.laiyifen.common.util.BusObjectHelper;

public class CompositeShopGeneralForm extends CompositeShopGeneralFormBase
{
	private SHOP_GENERAL_FORM shopGeneralFormObject = null;
	private SHOP_MASTER shopMasterObject = null;
    public CompositeShopGeneralForm()
    {
        this((BusObjectConfig)null);
    }

    public CompositeShopGeneralForm(BusObjectConfig config)
    {
        super(config);
    }

    public static com.laiyifen.shop.CompositeShopGeneralForm getCompositeShopGeneralFormByFilter(String shopId, String formId)
    {
    	CompositeShopGeneralForm  compositeShopGeneralForm = new CompositeShopGeneralForm();        
    	SHOP_MASTER shopMaster = SHOP_MASTER.getShopMasterObject(shopId);
    	compositeShopGeneralForm.setSHOP_MASTERObject(shopMaster);
    	SHOP_GENERAL_FORM shopGeneralForm = SHOP_GENERAL_FORM.getShopGeneralFormByFilter(shopId, formId);
    	compositeShopGeneralForm.setSHOP_GENERAL_FORMObject(shopGeneralForm);
    	compositeShopGeneralForm.makeTransient();
        return compositeShopGeneralForm;
    }

    public static BusObjectIterator<com.laiyifen.shop.CompositeShopGeneralForm> getCompositeShopGeneralFormObjects(com.cordys.cpc.bsf.query.Cursor cursor)
    {
        // TODO implement body
        return null;
    }

    public void onInsert()
    {
    	BusObjectHelper.removeEmptyChildren(this);
    	SHOP_GENERAL_FORM shopGenenralForm = this.getSHOP_GENERAL_FORMObject();
		if (shopGenenralForm != null) {
			shopGeneralFormObject = (SHOP_GENERAL_FORM) ObjectHelper
					.createObjectForInsert(shopGenenralForm,
							SHOP_GENERAL_FORM.class, false);
			shopGeneralFormObject.insert();
		}
    }

    public void onUpdate()
    {
    	BusObjectHelper.removeEmptyChildren(this);
    	SHOP_GENERAL_FORM shopGenenralForm = this.getSHOP_GENERAL_FORMObject();

		if (shopGenenralForm != null) {
			shopGeneralFormObject = (SHOP_GENERAL_FORM) ObjectHelper
					.createObjectForUpdate(shopGenenralForm,
							com.laiyifen.shop.SHOP_GENERAL_FORM.class, false);
			shopGeneralFormObject.update();
		}
		
		SHOP_MASTER shopmaster = this.getSHOP_MASTERObject();
		if (shopmaster != null) {
			shopMasterObject = (SHOP_MASTER) ObjectHelper
					.createObjectForUpdate(shopmaster,
							SHOP_MASTER.class, false);
			shopMasterObject.update();
		}
		
    }

    public void onDelete()
    {
    }
    
    @Override
	public void onAfterCommit(AfterCommitObjectEvent event) {
		// TODO Auto-generated method stub
    	super.onAfterCommit(event);
		this.createResponseObject();
		this.clear();
	}

	/**
	 * Create the composite response object.
	 */
	private void createResponseObject() {
		// Persistable objects we can modify, so first make transient.
		this.makeTransient();

		if (shopGeneralFormObject != null) {
			this.setSHOP_GENERAL_FORMObject(shopGeneralFormObject);
		}

	 
	}
	/**
	 * Clears the local variables.
	 */
	private void clear() {
		shopGeneralFormObject = null;
	}

}
