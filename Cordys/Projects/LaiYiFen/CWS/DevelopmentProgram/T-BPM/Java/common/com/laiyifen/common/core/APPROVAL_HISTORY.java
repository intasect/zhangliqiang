/*
  This class has been generated by the Code Generator
*/

package com.laiyifen.common.core;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.busobject.QueryObject;
import com.laiyifen.common.util.GUIDUtil;

public class APPROVAL_HISTORY extends APPROVAL_HISTORYBase
{
	private GUIDUtil guidGenerator = null;
    private String guidValue = null;
    
    public APPROVAL_HISTORY()
    {
        this((BusObjectConfig)null);
    }

    public APPROVAL_HISTORY(BusObjectConfig config)
    {
        super(config);
    }
    
    public void onBeforeInsert() {
    	if(guidGenerator == null)
		{
			guidGenerator = new GUIDUtil();
		}
		if(guidValue == null)
		{
			guidValue=guidGenerator.setGUID(null);
		}
		if(this.getID()==null ||this.getID().equals("")){
		   this.setID(guidValue);
		}
		User userInfo = null;
		if(this.getDEPT_CODE()==null ||this.getDEPT_CODE().equals("")){
			if(userInfo == null)
				userInfo = com.laiyifen.common.core.User.getUserInfo();
			this.setDEPT_CODE(userInfo.getDeptCode());
		}
		
		if(this.getDEPT_NAME()==null ||this.getDEPT_NAME().equals("")){
			if(userInfo == null)
				userInfo = com.laiyifen.common.core.User.getUserInfo();
			this.setDEPT_NAME(userInfo.getDeptName());
		}
		
		if(this.getOPERATOR_NAME()==null || this.getOPERATOR_NAME().equals("")){
			if(userInfo == null)
				userInfo = com.laiyifen.common.core.User.getUserInfo();
			this.setOPERATOR_NAME(userInfo.getUserName());
		}
		
		if(this.getOPERATOR_CODE()==null || this.getOPERATOR_CODE().equals("")){
			if(userInfo == null)
				userInfo = com.laiyifen.common.core.User.getUserInfo();
			this.setOPERATOR_CODE(userInfo.getUserCode());
		}
		
		if(this.getOPERATOR_ROLE_CODE()==null || this.getOPERATOR_ROLE_CODE().equals("")){
			if(userInfo == null)
				userInfo = com.laiyifen.common.core.User.getUserInfo();
			this.setOPERATOR_ROLE_CODE(userInfo.getRoleDNList());
		}
		
		if(this.getOPERATOR_ROLENAME()==null || this.getOPERATOR_ROLENAME().equals("")){
			if(userInfo == null)
				userInfo = com.laiyifen.common.core.User.getUserInfo();
			this.setOPERATOR_ROLENAME(userInfo.getRoleNameList());
		}
    }
    
    public static BusObjectIterator<com.laiyifen.common.core.APPROVAL_HISTORY> getApprovalHistory(String Form_ID)
    {
        String queryText = "select * from \"APPROVAL_HISTORY\" where \"FORM_ID\" = '" + Form_ID +"' order by operating_date";
        QueryObject query = new QueryObject(queryText);
        query.setResultClass(APPROVAL_HISTORY.class);
        return query.getObjects();
    }
    
    public static com.laiyifen.common.core.APPROVAL_HISTORY getApprovalHistoryByStepId(
			String formID, String stepCode) {
		String queryText = "select * from \"APPROVAL_HISTORY\" where \"FORM_ID\" = :FORM_ID and \"STEP_CODE\"=:STEP_CODE";
		QueryObject query = new QueryObject(queryText);
		query.addParameter("FORM_ID", "APPROVAL_HISTORY.FORM_ID",
				QueryObject.PARAM_STRING, formID);// NOPMD
		query.addParameter("STEP_CODE", "APPROVAL_HISTORY.STEP_CODE",
				QueryObject.PARAM_STRING, stepCode);// NOPMD
		query.setResultClass(APPROVAL_HISTORY.class);
		return (APPROVAL_HISTORY) query.getObject();
	}
}